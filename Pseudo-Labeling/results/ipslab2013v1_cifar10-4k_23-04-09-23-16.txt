['/content/drive/.shortcut-targets-by-id/1rq7ZwO6n9Qq8z-u9Ls5ROqESUr9unPFF/AdversarialAI/Pseudo-Labeling', '/content/drive/MyDrive/AdversarialAI/Poisoner', '/env/python', '/usr/lib/python39.zip', '/usr/lib/python3.9', '/usr/lib/python3.9/lib-dynload', '/usr/local/lib/python3.9/dist-packages', '/usr/lib/python3/dist-packages', './']
Namespace(print_freq=20, save_freq=100, save_dir='./checkpoints', dataset='cifar10', workers=4, num_labels=4000, sup_batch_size=64, usp_batch_size=64, data_twice=False, data_idxs=False, label_exclude=None, arch='cnn13', model='ipslab2013v1', drop_ratio=0.0, epochs=400, optim='sgd', momentum=0.9, nesterov=True, weight_decay=0.0005, lr=0.1, lr_scheduler='cos', min_lr=0.0001, steps=None, gamma=None, rampup_length=80, rampdown_length=50, t1=None, t2=None, soft=None, xi=None, eps=None, n_power=None, threshold=None, ema_decay=None, mixup_alpha=None, usp_weight=1.0, weight_rampup=30, ent_weight=None)
pytorch version : 2.0.0+cu118
getting cifar10 | subset size, labeled size, test size = [2000, 1500, 500]
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
labeled, unlabeled, test sizes: [1500, 500, 500]
malicious: horse , target: airplane
x_star: <class 'numpy.ndarray'>
x_target: <class 'numpy.ndarray'>
target and malicious images saved to ./data/poison/latest_poison
label_idxs: [1651, 1226, 52, 380, 1867, 734, 263, 1387, 1288, 596, 1004, 1469, 76, 674, 1377, 976, 1269, 85, 1843, 1472, 223, 440, 1146, 1174, 1868, 1290, 1019, 507, 1263, 1347, 1420, 233, 437, 1021, 865, 786, 937, 1405, 386, 392, 642, 1594, 1518, 1454, 396, 970, 432, 1282, 1504, 1172, 1093, 1245, 1150, 1914, 841, 1133, 237, 1558, 408, 1856, 1031, 1471, 1227, 1965, 1814, 619, 1395, 45, 1574, 719, 1260, 1417, 1742, 538, 810, 1126, 99, 1826, 953, 441, 1741, 1185, 1331, 975, 1237, 611, 1653, 1950, 468, 1960, 195, 1548, 653, 1422, 566, 1024, 1053, 1927, 116, 151, 241, 72, 1782, 578, 1204, 255, 1370, 228, 1047, 35, 301, 394, 691, 1342, 1880, 580, 1584, 1987, 419, 153, 817, 1371, 401, 1348, 201, 620, 1165, 1845, 1536, 1982, 880, 1629, 1515, 1065, 1421, 1573, 1346, 456, 1199, 1397, 1157, 1164, 370, 1243, 1649, 447, 133, 13, 672, 1817, 595, 1380, 1560, 1038, 1664, 714, 262, 1855, 1620, 1376, 171, 172, 1523, 1891, 1319, 1335, 895, 1922, 1356, 1647, 46, 769, 534, 359, 589, 1942, 1945, 1124, 1631, 1316, 249, 1507, 1144, 632, 876, 782, 1492, 1546, 1307, 492, 1070, 120, 772, 1438, 699, 1789, 520, 1655, 1562, 1793, 766, 956, 282, 142, 240, 1321, 832, 1194, 843, 774, 1864, 652, 256, 1218, 736, 1915, 503, 978, 1251, 1693, 1583, 1822, 1812, 318, 688, 645, 753, 811, 1791, 272, 1575, 1407, 820, 834, 614, 924, 60, 1887, 1937, 743, 1589, 209, 542, 1106, 68, 48, 515, 1576, 504, 1929, 757, 224, 1137, 1703, 1972, 633, 1009, 144, 336, 1512, 1329, 1092, 1778, 326, 705, 763, 1908, 189, 853, 1259, 1418, 616, 1385, 1298, 951, 732, 1930, 610, 717, 1294, 885, 903, 1648, 97, 135, 449, 842, 1183, 1936, 549, 670, 1519, 1050, 1007, 267, 1143, 1605, 271, 639, 563, 847, 911, 1767, 232, 166, 1587, 1650, 1951, 1697, 19, 857, 1549, 175, 1719, 1145, 79, 462, 576, 1735, 416, 1210, 730, 607, 1246, 648, 1783, 1022, 1997, 1105, 1365, 1450, 63, 1484, 148, 54, 710, 540, 406, 881, 623, 270, 1332, 1893, 1153, 44, 793, 815, 1244, 304, 1878, 275, 1907, 1393, 1, 1411, 697, 606, 1896, 1456, 217, 58, 24, 1830, 1369, 963, 1308, 523, 457, 1729, 716, 995, 974, 1706, 308, 328, 1813, 1095, 986, 1833, 983, 1925, 1979, 1207, 1102, 463, 399, 431, 1765, 795, 1166, 1399, 587, 145, 919, 1334, 1542, 347, 84, 1099, 916, 356, 939, 350, 1777, 498, 641, 737, 1301, 404, 1588, 1059, 368, 858, 1656, 1311, 96, 535, 1680, 512, 197, 792, 55, 1037, 1524, 637, 214, 1744, 656, 915, 1304, 1083, 323, 1324, 1957, 868, 1756, 439, 1355, 207, 1116, 731, 1797, 366, 545, 749, 123, 680, 1091, 1090, 164, 1551, 727, 585, 959, 423, 1766, 1608, 1072, 1674, 1895, 767, 615, 1722, 1475, 1502, 1229, 1082, 1354, 559, 1636, 1341, 1699, 1015, 1753, 1039, 722, 1740, 1673, 1974, 1917, 1366, 324, 83, 1547, 597, 12, 130, 156, 827, 1494, 1865, 856, 1383, 363, 590, 181, 968, 1280, 150, 493, 280, 962, 726, 1844, 517, 494, 435, 1666, 1113, 1252, 1963, 1916, 1368, 1381, 1296, 960, 514, 1681, 1240, 746, 1159, 818, 764, 973, 1784, 532, 509, 696, 303, 1732, 896, 1678, 1362, 56, 65, 1668, 1525, 1141, 1567, 897, 485, 1829, 1122, 1755, 390, 776, 1541, 413, 938, 839, 139, 1615, 117, 860, 1488, 800, 840, 1510, 910, 1128, 934, 1869, 1585, 1872, 1858, 957, 864, 1897, 473, 477, 1968, 136, 389, 1429, 475, 836, 427, 654, 316, 59, 584, 1028, 819, 3, 291, 369, 218, 1639, 996, 678, 1423, 446, 345, 928, 1328, 438, 1825, 402, 1627, 889, 690, 32, 1289, 888, 278, 1248, 558, 1208, 1944, 1862, 1630, 202, 222, 64, 1533, 1579, 215, 923, 1851, 671, 1003, 339, 212, 245, 706, 510, 1670, 572, 1779, 371, 1599, 659, 1932, 1846, 1490, 387, 687, 6, 1389, 1352, 778, 1453, 331, 997, 775, 53, 1224, 403, 801, 961, 1590, 524, 364, 1276, 695, 407, 381, 1215, 1205, 112, 327, 797, 1236, 643, 1018, 1041, 914, 1557, 1654, 1104, 305, 1720, 878, 686, 1724, 383, 220, 1416, 1414, 1923, 1231, 647, 1103, 1763, 1480, 1149, 739, 1616, 936, 1918, 90, 1192, 257, 277, 831, 796, 984, 1064, 0, 57, 158, 1926, 1398, 1848, 583, 191, 1130, 1708, 1163, 1835, 177, 252, 560, 745, 286, 570, 1295, 863, 357, 1008, 679, 1391, 1996, 991, 1981, 1659, 77, 508, 1746, 1618, 1564, 27, 821, 86, 1705, 464, 602, 704, 1959, 682, 1271, 1910, 7, 1818, 972, 992, 1042, 551, 75, 459, 1054, 1794, 2, 521, 1758, 1934, 1048, 1550, 1303, 344, 850, 1920, 1725, 274, 379, 1278, 1747, 1408, 1962, 1619, 1233, 1578, 664, 1496, 1202, 1571, 1136, 1657, 483, 1781, 1628, 828, 258, 1675, 1780, 1786, 677, 1247, 665, 1322, 759, 575, 66, 605, 322, 1768, 1890, 1452, 1002, 658, 1661, 799, 467, 1343, 721, 1535, 1345, 1406, 125, 1580, 1197, 1036, 1375, 1904, 315, 365, 543, 1710, 1500, 1213, 1155, 1317, 405, 1798, 1792, 598, 689, 1188, 229, 1107, 1127, 1976, 1696, 146, 1764, 1939, 816, 208, 794, 321, 226, 1242, 167, 781, 635, 1509, 1718, 873, 1795, 470, 1279, 91, 376, 1463, 969, 1010, 904, 871, 415, 1087, 375, 1148, 81, 748, 1912, 1033, 830, 780, 1482, 1161, 1532, 640, 239, 51, 1074, 1479, 273, 613, 1713, 1685, 990, 1973, 1977, 1057, 1006, 412, 982, 17, 1394, 285, 1568, 1566, 1119, 1660, 450, 87, 636, 1899, 1190, 1473, 1604, 675, 1750, 1212, 1169, 740, 1850, 1228, 1372, 299, 1873, 1275, 1733, 141, 373, 1374, 1154, 490, 867, 783, 666, 1483, 157, 1011, 1184, 1731, 875, 1544, 183, 1402, 340, 1958, 180, 908, 319, 132, 1635, 1266, 442, 1326, 1379, 625, 1162, 1998, 1745, 1264, 159, 1261, 1691, 693, 1881, 173, 377, 971, 1613, 838, 1684, 1555, 872, 1448, 1336, 428, 73, 1135, 1638, 168, 612, 1943, 1827, 360, 1181, 771, 230, 30, 476, 1820, 161, 1182, 1769, 1026, 501, 1176, 454, 121, 178, 887, 294, 184, 1132, 989, 1000, 122, 500, 106, 1969, 1991, 1751, 1363, 1679, 1061, 1147, 1330, 1273, 1816, 835, 518, 1597, 88, 741, 1607, 1577, 529, 495, 663, 855, 1711, 1665, 42, 15, 1051, 67, 1853, 1586, 478, 844, 1270, 341, 385, 18, 1919, 519, 1364, 235, 25, 964, 1885, 1220, 1748, 661, 1879, 1986, 1624, 1663, 1553, 993, 1459, 1312, 567, 1265, 1432, 711, 1632, 1221, 599, 200, 698, 1455, 1646, 1367, 513, 1828, 1193, 292, 899, 1838, 182, 1847, 198, 854, 750, 1005, 1461, 1283, 954, 591, 1115, 758, 987, 1662, 702, 660, 947, 348, 1120, 69, 1320, 1754, 264, 105, 469, 1695, 110, 298, 1516, 1487, 1071, 1291, 1513, 683, 335, 1905, 526, 949, 933, 1098, 8, 1602, 877, 378, 1017, 541, 188, 199, 338, 525, 546, 1428, 14, 119, 397, 40, 1297, 1068, 1086, 837, 1683, 101, 1134, 955, 755, 1712, 1640, 242, 358, 554, 1337, 314, 288, 421, 1285, 530, 1046, 622, 1985, 1569, 1889, 948, 1831, 1644, 1201, 725, 1338, 1327, 906, 1234, 1262, 333, 118, 1349, 1415, 82, 248, 998, 1239, 1344, 1014, 747, 884, 638, 1493, 1447, 1457, 391, 361, 1110, 1306, 883, 848, 1503, 1975, 1020, 4, 1595, 1823, 553, 701, 1734, 1935, 1860, 89, 1854, 1785, 1435, 1281, 1088, 1325, 946, 165, 28, 1256, 160, 452, 1652, 944, 1125, 1313, 826, 886, 1634, 1085, 98, 1444, 1396, 1025, 481, 522, 93, 1799, 29, 1171, 346, 1526, 573, 1688, 624, 126, 36, 94, 1121, 1520, 140, 349, 466, 1179, 1598, 932, 861, 1947, 1139, 571, 1286, 1677, 588, 205, 1645, 1123, 994, 1118, 1173, 577, 1983, 1436, 310, 1223, 511, 1774, 1274, 703, 581, 1940, 266, 1323, 1293, 1938, 1302, 1077, 196, 1253, 430, 1284, 1967, 1761, 967, 149, 1267, 667, 600, 1403, 1361, 777, 556, 754, 1614, 1466, 669, 382, 770, 751, 1698, 268, 1559, 289, 1902, 1563, 104, 460, 1715, 528, 1954, 979, 684, 487, 1062, 162, 192, 169, 779, 1300, 1669, 505, 253, 1187, 1412, 685, 124, 729, 176, 420, 1600, 154, 295, 1076, 243, 564, 1211, 1043, 1582, 1866, 536, 1214, 47, 1964, 621, 802, 1949, 1373, 1762, 265, 760, 931, 808, 499, 424, 1898, 1815, 544, 627, 1924, 1610, 761, 1495, 1178, 1894, 480, 533, 1737, 1001, 958, 297, 279, 1160, 34, 788, 1305, 628, 1992, 453, 617, 1465, 1413, 662, 320, 1508, 790, 940, 966, 1521, 39, 942, 527, 1909, 418, 1808, 548, 813, 1034, 95, 692, 1994, 1874, 1802, 1592, 1314, 1055, 1886, 913, 531, 1538, 445, 791, 568, 1572, 374, 1875, 762, 1029, 1531, 657, 1177, 1743, 1045, 1257, 1787, 422, 1876, 952, 1140, 1129, 912, 773, 1501, 1717, 293, 353, 1292, 901, 194, 1442, 1980, 1859, 1739, 807, 111, 594, 1196, 891, 1462, 1921, 219, 593, 451, 1035, 1633, 516, 236, 179, 1277, 1810, 626, 488, 1255, 720, 238, 902, 1084, 1030, 216, 918, 1625, 1446, 259, 342, 1152, 1131, 1692, 92, 395, 1158, 1978, 203, 5, 1953, 20, 41, 1424, 254, 21, 1759, 1773, 981, 785, 109, 343, 723, 1528, 1570, 1474, 74, 1476, 472, 1770, 1760, 1052, 1481, 1309, 107, 1821, 170, 1694, 1401, 231, 1704, 965, 1318, 586, 131, 1537, 296, 246, 80, 1539, 443, 227, 1971, 900, 1658, 1956, 1522, 1040, 325, 351, 561, 681, 1189, 709, 334, 765, 317, 393, 1730, 806, 569, 1075, 644, 37, 1870, 1142, 935, 537, 190, 1609, 1073, 461, 276, 1359, 1044, 1714, 1351, 1225, 1836, 1984, 1112, 1023, 210, 555, 1849, 31, 425, 917, 290, 1451, 1489, 1467, 1080, 1728, 352, 1596, 1441, 1811, 1235, 1392, 502, 497, 1049, 870, 1995, 988, 825, 814, 409, 927, 925, 650, 484, 630, 43, 1470, 1191, 809, 1819, 1772, 1933, 211, 1478, 1078, 1232, 100, 1167, 1687, 1641, 306, 284, 1611, 1333, 1776, 592, 261, 1871, 417, 805, 930, 1989, 700, 1883, 547, 367, 1805, 206, 221, 1643, 1626, 1723, 414, 1203, 1702, 631, 23, 1063, 332, 922, 103, 892, 724, 852, 1839, 486, 1216, 1529, 941, 1168, 1534, 1433, 152, 1707, 694, 1788, 1606, 61, 1527, 1170, 410, 10, 1460, 1796, 1230, 1834, 943, 713, 1824, 234, 1672, 1449, 138, 905, 787, 134, 247, 985, 1458, 1156, 846, 1622, 1268, 11, 1437, 909, 1556, 1948, 1287, 1841, 1013, 1775, 673, 1339, 1736, 1032, 147, 565, 1857, 33, 1272, 1505, 1990, 1961, 1067, 108, 823, 1477, 1299, 718, 707, 1716, 715, 1790, 1906, 426, 1258, 400, 1840, 115, 16, 1617, 482, 300, 1727, 433, 1217, 49, 574, 1254, 1861, 1686, 1498, 269, 312, 1804, 1111, 187, 354, 1545, 1434, 1206, 113, 1671, 225, 1842, 609, 474, 287, 608, 1357, 604, 1941, 1390, 1946, 1439, 489, 1222, 1079, 1464, 950, 1195, 1892, 1970, 1486, 444, 1089, 752, 907, 1100, 1138, 579, 1690, 1591, 1241, 1757, 768, 1993, 491, 550, 1721, 1016, 539, 1888, 1903, 1117, 1200, 50, 733, 1999, 1637, 185, 980, 1378, 742, 1955, 712, 283, 1726, 1310, 411, 744, 1621, 1404, 1581, 155, 1612, 1771, 804, 634, 1700, 496, 829, 1012, 1565, 668, 434, 102, 1094, 362, 1882, 738, 1749, 1540, 1180, 1601, 618, 1443, 1900, 1114, 1468, 1832, 977, 1430, 1806, 879, 38, 1358, 9, 629, 1623, 894, 1066, 26, 1350, 1060, 506, 708, 1752, 309, 798, 1952, 479, 465, 388, 174, 71, 1388, 186, 436, 1058, 1101, 384, 114, 789, 127, 398, 281, 557, 874, 1056, 1807, 251, 1593, 849, 1667, 311, 1738, 1801, 1069, 455, 1096, 1931, 1966, 676, 355, 78, 833, 862, 1219, 1901, 1491, 1440, 1852, 1027, 302, 1249, 62, 1431, 458, 1409, 1386, 1863, 646, 784, 70, 1425, 582, 1514, 448, 1800, 129, 1209, 137, 372, 1426, 1913, 851, 193, 1419, 1109, 869, 562, 1928, 1682, 1709, 803, 1499, 649, 307, 890, 655, 1410, 1186, 1877, 945, 1506, 1485, 1911, 603, 728, 1561, 1445, 1427, 824, 313, 1988, 1250, 1108, 330, 128, 471, 22, 337, 1400, 859, 1803, 882, 822, 260, 1382, 1554, 1701, 921, 1543, 1340, 429, 893, 1642, 204, 845, 929, 143, 244, 866, 1517, 1530, 163, 1884, 1360, 920, 651, 756, 601, 1552, 1175, 250, 812, 1151, 1603, 1497, 1097, 1384, 1676, 999, 329, 926, 1511, 1315, 1238, 1081, 1353, 1198, 735, 213, 552, 1689, 1809, 898, 1837]/usr/local/lib/python3.9/dist-packages/torch/utils/data/dataloader.py:561: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/usr/local/lib/python3.9/dist-packages/torch/utils/data/dataloader.py:561: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/usr/local/lib/python3.9/dist-packages/torch/optim/lr_scheduler.py:139: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "

unlab_idxs: [2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025, 2026, 2027, 2028, 2029, 2030, 2031, 2032, 2033, 2034, 2035, 2036, 2037, 2038, 2039, 2040, 2041, 2042, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2052, 2053, 2054, 2055, 2056, 2057, 2058, 2059, 2060, 2061, 2062, 2063, 2064, 2065, 2066, 2067, 2068, 2069, 2070, 2071, 2072, 2073, 2074, 2075, 2076, 2077, 2078, 2079, 2080, 2081, 2082, 2083, 2084, 2085, 2086, 2087, 2088, 2089, 2090, 2091, 2092, 2093, 2094, 2095, 2096, 2097, 2098, 2099]
Pseudo-Label-v1 2013 with iteration pseudo labels
------ Training epochs: 0 ------
[train][0  ] lloss: 2.32563	uloss: N/A	lacc: 6.250%	uacc: N/A
>>>[train] lloss: 2.32563	uloss: N/A	lacc: 6.250%	uacc: N/A
------ Testing epochs: 0 ------
[test][0  ] lloss: 2.30295	lacc: 11.719%
>>>[test] lloss: 9.22652	lacc: 10.000%
------ Training epochs: 1 ------
[train][0  ] lloss: 1.65418	uloss: N/A	lacc: 54.688%	uacc: N/A
>>>[train] lloss: 1.65418	uloss: N/A	lacc: 54.688%	uacc: N/A
------ Testing epochs: 1 ------
[test][0  ] lloss: 2.30933	lacc: 11.719%
>>>[test] lloss: 9.26801	lacc: 10.000%
------ Training epochs: 2 ------
[train][0  ] lloss: 1.66242	uloss: N/A	lacc: 51.562%	uacc: N/A
>>>[train] lloss: 1.66242	uloss: N/A	lacc: 51.562%	uacc: N/A
------ Testing epochs: 2 ------
[test][0  ] lloss: 2.29741	lacc: 11.719%
>>>[test] lloss: 9.23576	lacc: 10.000%
------ Training epochs: 3 ------
[train][0  ] lloss: 2.07678	uloss: N/A	lacc: 46.094%	uacc: N/A
>>>[train] lloss: 2.07678	uloss: N/A	lacc: 46.094%	uacc: N/A
------ Testing epochs: 3 ------
[test][0  ] lloss: 2.41735	lacc: 8.594%
>>>[test] lloss: 9.79216	lacc: 8.600%
------ Training epochs: 4 ------
[train][0  ] lloss: 1.46724	uloss: N/A	lacc: 55.469%	uacc: N/A
>>>[train] lloss: 1.46724	uloss: N/A	lacc: 55.469%	uacc: N/A
------ Testing epochs: 4 ------
[test][0  ] lloss: 2.55761	lacc: 10.156%
>>>[test] lloss: 10.23695	lacc: 9.800%
------ Training epochs: 5 ------
[train][0  ] lloss: 1.37308	uloss: N/A	lacc: 57.031%	uacc: N/A
>>>[train] lloss: 1.37308	uloss: N/A	lacc: 57.031%	uacc: N/A
------ Testing epochs: 5 ------
[test][0  ] lloss: 2.76377	lacc: 12.500%
>>>[test] lloss: 10.77898	lacc: 10.400%
------ Training epochs: 6 ------
[train][0  ] lloss: 1.21094	uloss: N/A	lacc: 57.812%	uacc: N/A
>>>[train] lloss: 1.21094	uloss: N/A	lacc: 57.812%	uacc: N/A
------ Testing epochs: 6 ------
[test][0  ] lloss: 3.61477	lacc: 13.281%
>>>[test] lloss: 14.11402	lacc: 10.800%
------ Training epochs: 7 ------
